<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  

<mapper namespace="com.library.mapper.mylib.NotebookRoomMapper">

	<!-- 좌석 정보 출력(전체 | 로그인한 기준) -->
	<!-- 전체 좌석 조회 -->
	<select id="nbRoom_list_all" resultType="com.library.model.mylib.NoteBookRoomDTO">
		select *
		  from reading_room where seat_no &gt; 96
		 order by seat_no
	</select>
	<!-- 예약 좌석 조회 -->
	<select id="nbRoom_info" resultType="com.library.model.mylib.NoteBookRoomDTO">
		select *
		  from reading_room 
		 where  user_id = #{user_id}
	</select>



	<!-- 예약 | 좌석 이동 | 퇴실 | 좌석 시간 연장 -->
	<!-- 좌석 예약 -->
	<update id="nbRoom_booking">
		update reading_room
		   set user_id = #{user_id}, checkin_time = current_timestamp, checkout_time = date_add(current_timestamp, INTERVAL 3 HOUR) 
		 where seat_no = #{seat_no}
	</update>
	<!-- 좌석 상태 체크 -->
	<select id="nb_seat_check" resultType="int">
		select count(*) 
		  from reading_room
		 where seat_no = #{seat_no} and user_id is null
	</select>








	<!-- 좌석 insert(test에서 진행) -->
	<insert id="insert">
		insert into reading_room values(#{seat_no}, null, null, null);
	</insert>
</mapper>